<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">

    <ui:composition>

        <p:dialog id="PqrEditDlg"  style="width:10%" widgetVar="PqrEditDialog" closable="false" modal="true" resizable="false" 
                  appendTo="@(body)" header="#{bundle.EditPqrTitle}">
            <h:form id="PqrEditForm"> 
                <h:panelGroup id="display">
                    <p:panelGrid style="width:96%" columns="6" rendered="#{pqrController.selected != null}">
                        <p:outputLabel value="#{bundle.CreatePqrLabel_fechaCreacion}" for="fechaCreacion" />
                        <p:inputText style="width:60%" readonly="true" id="fechaCreacion"  
                                       value="#{pqrController.selected.fechaCreacion}" >
                            <f:convertDateTime pattern="dd/MM/yyyy" />
                        </p:inputText>
                        
                        <p:outputLabel value="#{bundle.CreatePqrLabel_idTipoPqr}" for="idTipoPqr" />
                        <p:inputText readonly="true" style="width:100%" id="idTipoPqr" value="#{pqrController.selected.idTipoPqr.nombre}" />
                        
                        <p:outputLabel value="#{bundle.CreatePqrLabel_estado}" for="estadoPqr" />
                        <p:inputText readonly="true" style="width:100%" id="estadoPqr" value="#{pqrController.selected.idEstadoPqr.nombre}" />
                    </p:panelGrid>
                    <p:spacer height="1" />
                    <p:panelGrid  style="width:96%" columns="2">
                              <p:outputLabel value="Asunto:  " for="asunto" />
                               <p:inputText readonly="true" style="width:95%" id="asunto"  value="#{pqrController.selected.asunto}"/> 

                              <p:outputLabel value="Descripcion:  " for="descripcion" />
                              <p:inputTextarea readonly="true" style="width:95%"  id="descripcion" value="#{pqrController.selected.descripcion}" />
                    </p:panelGrid>
                    <p:spacer height="1" />
                    <p:panelGrid style="width:96%" columns="4" rendered="#{pqrController.selected != null}">                           
                        <p:outputLabel value="#{bundle.CreatePqrLabel_idNivel2}" for="idNivel2" />
                        <p:inputText style="width:90%" readonly="true"  id="idNivel2" value="#{pqrController.selected.idNivel2.idNivel1.idTipo.nombre.concat(' ')
                                                                                   .concat(pqrController.selected.idNivel2.idNivel1.referencia).concat(' ')
                                                                                   .concat(pqrController.selected.idNivel2.idTipo.nombre).concat(' ')
                                                                                   .concat(pqrController.selected.idNivel2.referencia)}" />
                        <p:outputLabel value="#{bundle.CreatePqrLabel_idNivel3}" for="idNivel3" />
                        <p:inputText style="width:90%" readonly="true"  id="idNivel3" value="#{pqrController.selected.idNivel3.idTipo.nombre.concat(' ')
                                                        .concat(pqrController.selected.idNivel3.referencia)}" />                        
                        <p:outputLabel value="#{bundle.CreatePqrLabel_idTercero}" for="idTercero" />
                        <p:inputText style="width:90%" readonly="true"  id="idTercero" value="#{pqrController.selected.idTercero.nombre}" />                            
                        <p:outputLabel value="#{bundle.CreatePqrLabel_idUsuario}" for="idUsuario" />
                        <p:inputText style="width:90%" readonly="true" id="idUsuario" value="#{pqrController.selected.idUsuario.nombres.concat(' ')
                                                        .concat(pqrController.selected.idUsuario.apellidos)}" />
                        <p:commandButton actionListener="#{pqrController.prepareCreateSegumientoPQR}" update=":SeguimientoAdmPqrCreateForm"
                                         value="Agregar" oncomplete="PF('SeguimientoAdmPqrCreateDialog').show()"/>
                    </p:panelGrid> 
                  </h:panelGroup>
            </h:form>
            <p:spacer height="3" />
            <p:panelGrid style="width:96%" columns="2">
            <h:form id="PqrDatalistForm">
                <p:panel header="Seguimiento PQR">
            <p:dataTable id="datalist" value="#{pqrController.lista_seguimientoAdmPqr}" var="item"
                                 selectionMode="single" selection="#{pqrController.selectedEditSeguimientoAdmPqr}" 
                                 paginator="true" paginatorPosition="bottom"
                                 rowKey="#{item.id}"
                                 rows="10"
                                 rowsPerPageTemplate="10,20,30,40,50"
                                 >
                        <p:ajax event="rowSelect"   update="editButton "/>
                        <p:ajax event="rowUnselect" update="editButton "/>                
                        <p:column style="width:30%">
                            <f:facet name="header">
                                <h:outputText value="fecha Creacion"/>
                            </f:facet>
                            <h:outputText value="#{item.fechaCreacion}">
                                <f:convertDateTime pattern="dd/MM/yyyy" />
                            </h:outputText>                            
                        </p:column>
                        <p:column style="width:90%">
                            <f:facet name="header">
                                <h:outputText value="#{bundle.ListSeguimientoAdmPqrTitle_descripcion}"/>
                            </f:facet>
                            <h:outputText value="#{item.descripcion}"/>
                        </p:column>
                        <p:column style="width:30%">
                            <f:facet name="header">
                                <h:outputText value="fecha Ejecucion "/>
                            </f:facet>
                            <h:outputText value="#{item.fechaEjecucion}">
                                <f:convertDateTime pattern="dd/MM/yyyy" />
                            </h:outputText>                            
                        </p:column>
                        <p:column style="width:30%">
                            <f:facet name="header">
                                <h:outputText value="fecha Fin Ejecucion "/>
                            </f:facet>
                            <h:outputText value="#{item.fechaFinEjecucion}">
                                <f:convertDateTime pattern="dd/MM/yyyy" />
                            </h:outputText>                            
                        </p:column>                
                        <p:column style="width:30%">
                            <f:facet name="header">
                                <h:outputText value="Estado"/>
                            </f:facet>
                            <h:outputText value="#{item.estado}"/>
                        </p:column>
                        <p:column style="width:70%">
                            <f:facet name="header">
                                <h:outputText value="Usuario"/>
                            </f:facet>
                            <h:outputText value="#{item.idUsuario.nombres.concat(' ').concat(item.idUsuario.apellidos)}"/>
                        </p:column>
                        <f:facet name="footer">
                            <p:commandButton id="editButton"   icon="ui-icon-pencil" value="#{bundle.Edit}" 
                                             actionListener="#{pqrController.actualizarListaSegumientoPqr}" 
                                             update=":SeguimientoAdmPqrEditForm,:PqrDatalistForm:datalist" 
                                             oncomplete="PF('SeguimientoAdmPqrEditDialog').show()"
                                             disabled="#{empty pqrController.selectedEditSeguimientoAdmPqr}"/>
                            <p:commandButton id="CerrarButton"   value="Cerrar" 
                                             actionListener="#{pqrController.cerrarPqr}" 
                                             update=":PqrDatalistForm:datalist" 
                                             onclick="PqrEditDialog.hide()"
                                             />                             
                        </f:facet>                
                    </p:dataTable>
                    </p:panel>
                </h:form>
                 </p:panelGrid>
        </p:dialog>
           <ui:include src="Create_segumientoAdmin.xhtml"/>
           <ui:include src="Edit_segumientoAdmin.xhtml"/>
    </ui:composition>
</html>
